<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Botographs</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <header>
    <h1>Botographs</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="admin.html">Admin</a>
      <button id="logout">Logout</button>
    </nav>
  </header>
  <main>
    <div id="gallery" class="gallery-grid"></div>
  </main>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-auth-compat.js"></script>

  <script>
    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCAP8YNuORmIr4JY_1hbRNneCMsP6lHnSw",
      authDomain: "photography-website-8654f.firebaseapp.com",
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // Protect this page: redirect to login if not signed in
    auth.onAuthStateChanged(user => {
      if (!user) {
        window.location.href = 'login.html';
      } else {
        loadGallery();
      }
    });

    document.getElementById('logout').onclick = () => {
      auth.signOut().then(() => window.location.reload());
    };

    // Fetch the photo manifest from GitHub and render
    async function loadGallery() {
      const resp = await fetch('https://raw.githubusercontent.com/BaoNHoang/Botographs.github.io/main/photos/photos.json');
      const photos = await resp.json();
      const gallery = document.getElementById('gallery');
      photos.forEach(p => {
        const img = document.createElement('img');
        img.src = p.url;
        img.alt = p.caption || '';
        img.classList.add('gallery-item');
        gallery.appendChild(img);
      });
    }
  </script>
</body>
</html>
